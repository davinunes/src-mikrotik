#--------------------------------------------------------------------------------------------------------#
#    Monte a Lista de Usuarios Conectados Via radius
#--------------------------------------------------------------------------------------------------------#
:local conectados;
set conectados [ppp active find where radius=no]
#--------------------------------------------------------------------------------------------------------#
#    Pra cada Item da Lista de Conectados
#--------------------------------------------------------------------------------------------------------#
:foreach i in=[$conectados] do={
#--------------------------------------------------------------------------------------------------------#
#    Define o Login
#--------------------------------------------------------------------------------------------------------#
:local nome [/ppp active get value-name=name number=$i]
:put $nome
#--------------------------------------------------------------------------------------------------------#
#    Verifica se está cadastrado
#--------------------------------------------------------------------------------------------------------#
:local teste [/ppp secret find name=$nome]
#--------------------------------------------------------------------------------------------------------#
#    Se não tiver cadastrado, cadastre
#--------------------------------------------------------------------------------------------------------#
:if ($teste="") do={
#--------------------------------------------------------------------------------------------------------#
#    Adiciona o Nome nos Secrets
#--------------------------------------------------------------------------------------------------------#
/ppp secret add name=$nome password=$nome service=pppoe \
profile=Geral comment="Cadastrado pelo Script" disabled=yes
}
}
#-------------------------------------------------------------------------------------------------------#
ppp secret rem [/ppp secret find name=""]